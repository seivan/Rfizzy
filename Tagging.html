<!DOCTYPE html>  <html> <head>   <title>Tagging.rb</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="FullTextSearch.html">                 FullTextSearch.rb               </a>                                           <a class="source" href="Tagging.html">                 Tagging.rb               </a>                                           <a class="source" href="installation_and_setup.html">                 installation_and_setup.rb               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               Tagging.rb             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h2>Tagging</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>We are using an ActiveRecord model here.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nc">Article</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span> 
  </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>With it's complimentary callbacks</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="n">after_create</span> <span class="ss">:create_search_index</span>
  <span class="n">before_destroy</span> <span class="ss">:destroy_search_index</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>But you can just as well use any other orm that gives it's documents/tables unique identifiers (id's)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kp">private</span>
  <span class="k">def</span> <span class="nf">create_search_index</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>So we set the namespace we want the searching to be on by setting it's name :article_tags
We pass the article's id to it so we can find it
And we pass the articles tags as an array
Naturally the tags can just be a virtual attribute as an array of tags when posting the article</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="no">TaggyMcFaggy</span><span class="o">.</span><span class="n">create_index</span> <span class="ss">:attribute_namespace</span> <span class="o">=&gt;</span> <span class="ss">:article_tags</span><span class="p">,</span>
                                <span class="ss">:document_id</span> <span class="o">=&gt;</span> <span class="nb">id</span><span class="p">,</span>
                                <span class="ss">:words</span> <span class="o">=&gt;</span> <span class="n">tags</span>
                              
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">destroy_search_index</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Same concept applies here, except we don't care about the tags themselves.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="no">TaggyMcFaggy</span><span class="o">.</span><span class="n">destroy_index</span>  <span class="ss">:attribute_namespace</span> <span class="o">=&gt;</span> <span class="ss">:article_text</span><span class="p">,</span>
                                  <span class="ss">:document_id</span> <span class="o">=&gt;</span> <span class="nb">id</span>
    
  <span class="k">end</span>
<span class="k">end</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Pass in an array of tags, or a single tag as a text</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="n">set_of_ids</span> <span class="o">=</span> <span class="no">TaggyMcFaggy</span><span class="o">.</span><span class="n">search_index</span> <span class="ss">:attribute_namespace</span> <span class="o">=&gt;</span> <span class="ss">:article_text</span><span class="p">,</span>
                                         <span class="ss">:search</span> <span class="o">=&gt;</span> <span class="s2">&quot;food&quot;</span>
                                         </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>And no matter if you're using Mongoid, ActiveRecord or DataMapper, you can now query the ID's.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="no">Article</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="ss">:id</span> <span class="o">=&gt;</span> <span class="n">set_of_ids</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Now lets assume we want to limit to who can search what by setting an association</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">def</span> <span class="nf">create_search_index</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Notice the assoction on article.user.id</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="no">TaggyMcFaggy</span><span class="o">.</span><span class="n">create_index</span> <span class="ss">:attribute_namespace</span> <span class="o">=&gt;</span> <span class="ss">:article_text</span><span class="p">,</span>
                                <span class="ss">:document_id</span> <span class="o">=&gt;</span> <span class="nb">id</span><span class="p">,</span>
                                <span class="ss">:words</span> <span class="o">=&gt;</span> <span class="n">text_content</span><span class="p">,</span>
                                <span class="ss">:association</span> <span class="o">=&gt;</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span>
                              
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">destroy_search_index</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Same concept applies here, except we really do not care about the tags when deleting</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="no">TaggyMcFaggy</span><span class="o">.</span><span class="n">destroy_index</span>  <span class="ss">:attribute_namespace</span> <span class="o">=&gt;</span> <span class="ss">:article_text</span><span class="p">,</span>
                                  <span class="ss">:document_id</span> <span class="o">=&gt;</span> <span class="nb">id</span><span class="p">,</span>
                                  <span class="ss">:association</span> <span class="o">=&gt;</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>

  <span class="k">end</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>And when the current_user searches he will only find on his own associated tweets</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="n">set_of_ids</span> <span class="o">=</span> <span class="no">TaggyMcFaggy</span><span class="o">.</span><span class="n">search_index</span>  <span class="ss">:attribute_namespace</span> <span class="o">=&gt;</span> <span class="ss">:article_text</span><span class="p">,</span>
                                          <span class="ss">:association</span> <span class="o">=&gt;</span> <span class="n">current_user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                                          <span class="ss">:search</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;Food&quot;</span><span class="p">,</span> <span class="s2">&quot;gaming&quot;</span><span class="p">,</span> <span class="s2">&quot;Balls&quot;</span><span class="o">]</span>
  </pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <hr />             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h2>But wait! ... there's more</h2>

<h3>What can I do with this?</h3>

<ul>
<li><p><a href="http://seivan.github.com/Rfizzy/Tagging.html">Tagging - find posts through tagging, find tags through posts</a></p></li>
<li><p><a href="http://seivan.github.com/Rfizzy/FullTextSearch.html">Full text search -through association or attributes</a></p></li>
<li><p>Social Graph, friends, followers, followees</p></li>
</ul>

<p>You can find more advanced examples by using the "Jumper" placed at the upper right corner</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <hr />             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h2>Links</h2>

<ul>
<li><a href="https://github.com/seivan/Rfizzy">Check out the source code on Github</a></li>
<li><a href="https://github.com/seivan/Rfizzy/issues">Found a bug or do you have a feature request?</a></li>
<li><a href="http://travis-ci.org/seivan/Rfizzy">Continues build and testing status</a></li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 